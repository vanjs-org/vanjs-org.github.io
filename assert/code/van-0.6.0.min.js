let e=Array.isArray,t=document,o=e=>"object"!=typeof e?t.createTextNode(e):e;export let add=(t,...r)=>{for(let l of r)e(l)?add(t,...l):t.appendChild(o(l))};let r,l=(o,...r)=>{let[l,n]="object"!=typeof r[0]||r[0]instanceof Node||e(r[0])?[{},r]:[r[0],r.slice(1)],d=t.createElement(o);for(let[e,t]of Object.entries(l))t&&(e.startsWith("on")?d[e]=t:d.setAttribute(e,t));return add(d,...n),d};export let tags=(...e)=>Object.fromEntries(e.map((e=>[e,l.bind(null,e)])));export let state=e=>({val:e,t:[]});export let bind=(t,r,l=(e=>o(r(...e))))=>{if(!e(t))return bind([t],r,l);let n=o(r(...t.map((e=>e.val)))),d={o:t,l:n,i:l,u:r};for(let e of t)e.t.push(d);return n};let n=()=>{let e=r;r=null;for(let t of e){let{l:e,o:o,i:r}=t;if(!e.isConnected)continue;let l=r(o.map((e=>e.val)),o.map((e=>e.p)),e,t.u);l!==e&&(e.replaceWith(l),t.l=l)}};export let setState=(t,o)=>{if(!e(t))return setState([t],[o]);for(let e=0;e<t.length;++e){let d=t[e];if(d.t=d.t.filter((e=>e.l.isConnected)),o[e]!==d.val){d.p=d.val,d.val=o[e];for(let e of d.t)l=e,r=(r??(setTimeout(n,0),new Set)).add(l)}}var l};