let e=Array.isArray,t=document,r=e=>e instanceof Node?e:t.createTextNode(e);export let add=(t,...d)=>d.forEach((d=>e(d)?add(t,...d):t.appendChild(r(d))));let d,l=(e,...r)=>{let[d,l]=r[0]?.constructor===Object?[r[0],r.slice(1)]:[{},r],n=t.createElement(e);return Object.entries(d).forEach((([e,t])=>{t&&(e.startsWith("on")?n[e]=t:n.setAttribute(e,t))})),add(n,...l),n};export let tags=(...e)=>Object.fromEntries(e.map((e=>[e,l.bind(null,e)])));export let state=e=>({val:e,t:[]});export let bind=(t,d,l=(e=>r(d(...e))))=>{if(!e(t))return bind([t],d,l);let n=r(d(...t.map((e=>e.val)))),o={l:t,o:n,i:l,u:d};return t.forEach((e=>e.t.push(o))),n};let n=e=>d=(d??(setTimeout(o,0),new Set)).add(e),o=()=>{let e=d;d=null,e.forEach((e=>{let{o:t,l:r,i:d}=e;if(t.isConnected){let l=d(r.map((e=>e.val)),r.map((e=>e.p)),t,e.u);l!==t&&(t.replaceWith(l),e.o=l)}}))};export let setState=(t,r)=>{if(!e(t))return setState([t],[r]);t.forEach(((e,t)=>{e.t=e.t.filter((e=>e.o.isConnected)),r[t]!==e.val&&(e.p=e.val,e.val=r[t],e.t.forEach(n))}))};