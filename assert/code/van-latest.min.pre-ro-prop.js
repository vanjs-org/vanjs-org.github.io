let e,t,o,l=Object,r=l.getPrototypeOf,n=(e,t,o,l)=>(e??(setTimeout(o,l),new Set)).add(t),f={get val(){return this.t},set val(e){let o=this,l=o.t;if(e!==l){o.o===l?t=n(t,o,_):e===o.o&&t.delete(o),o.t=e;for(let t of o.l)t(e,l)}},onnew(e){this.l.push(e)}},s=r(f),d=e=>e.nodeType?e:new Text(e),i=(e,...t)=>{for(let o of t.flat(1/0))e.appendChild(r(o)===f?w(o,e=>e):d(o));return e},u=new Proxy((t,...o)=>{let[n,...d]=r(o[0]??0)===s?o:[{},...o],u=document.createElement(t);for(let[t,o]of l.entries(n)){let l=u[t]!==e?e=>u[t]=e:e=>u.setAttribute(t,e);r(o)===f?w(o,e=>(l(e),u)):r(o)===s?w(...o.deps,(...e)=>(l(o.f(...e)),u)):l(o)}return i(u,...d)},{get:(t,o)=>t.bind(e,o)}),a=e=>e.i=e.i.filter(e=>e.u?.isConnected),_=()=>{let o=[...t];t=e;for(let t of new Set(o.flatMap(a))){let{_:o,u:l}=t,r=t.g(...o.map(e=>e.t),l,...o.map(e=>e.o));r!==l&&(r!=e?l.replaceWith(t.u=d(r)):(l.remove(),t.u=e))}for(let e of o)e.o=e.t},w=(...t)=>{let l=t.pop(),r=l(...t.map(e=>e.t));if(r==e)return[];let f={_:t,u:d(r),g:l};for(let l of t)o=n(o,l,()=>(o.forEach(a),o=e),1e3),l.i.push(f);return f.u};export default{add:i,tags:u,state:e=>({__proto__:f,t:e,o:e,i:[],l:[]}),bind:w};