let e=Array.isArray,t=document,r=e=>"object"!=typeof e?t.createTextNode(e):e;export let add=(t,...d)=>d.forEach((d=>e(d)?add(t,...d):t.appendChild(r(d))));let d,l=(r,...d)=>{let[l,n]="object"!=typeof d[0]||d[0]instanceof Node||e(d[0])?[{},d]:[d[0],d.slice(1)],o=t.createElement(r);return Object.entries(l).forEach((([e,t])=>{t&&(e.startsWith("on")?o[e]=t:o.setAttribute(e,t))})),add(o,...n),o};export let tags=(...e)=>Object.fromEntries(e.map((e=>[e,l.bind(null,e)])));export let state=e=>({val:e,t:[]});export let bind=(t,d,l=(e=>r(d(...e))))=>{if(!e(t))return bind([t],d,l);let n=r(d(...t.map((e=>e.val)))),o={l:t,o:n,i:l,p:d};return t.forEach((e=>e.t.push(o))),n};let n=e=>d=(d??(setTimeout(o,0),new Set)).add(e),o=()=>{let e=d;d=null,e.forEach((e=>{let{o:t,l:r,i:d}=e;if(t.isConnected){let l=d(r.map((e=>e.val)),r.map((e=>e.u)),t,e.p);l!==t&&(t.replaceWith(l),e.o=l)}}))};export let setState=(t,r)=>{if(!e(t))return setState([t],[r]);t.forEach(((e,t)=>{e.t=e.t.filter((e=>e.o.isConnected)),r[t]!==e.val&&(e.u=e.val,e.val=r[t],e.t.forEach(n))}))};