let e=Array.isArray,t=document,r=Object,d=e=>e instanceof Node?e:t.createTextNode(e);export let add=(t,...r)=>r.forEach((r=>e(r)?add(t,...r):t.appendChild(d(r))));let l,n=(e,...d)=>{let[l,n]=d[0]?.constructor===r?[d[0],d.slice(1)]:[{},d],o=t.createElement(e);return r.entries(l).forEach((([e,t])=>{t&&(e.startsWith("on")?o[e]=t:o.setAttribute(e,t))})),add(o,...n),o};export let tags=(...e)=>r.fromEntries(e.map((e=>[e,n.bind(null,e)])));export let state=e=>({val:e,t:[]});export let bind=(t,r,l=(e=>d(r(...e))))=>{if(!e(t))return bind([t],r,l);let n=d(r(...t.map((e=>e.val)))),o={l:t,o:n,i:l,u:r};return t.forEach((e=>e.t.push(o))),n};let o=e=>l=(l??(setTimeout(a,0),new Set)).add(e),a=()=>{let e=l;l=null,e.forEach((e=>{let{o:t,l:r,i:d}=e;if(t.isConnected){let l=d(r.map((e=>e.val)),r.map((e=>e.p)),t,e.u);l!==t&&(t.replaceWith(l),e.o=l)}}))};export let setState=(t,r)=>{if(!e(t))return setState([t],[r]);t.forEach(((e,t)=>{e.t=e.t.filter((e=>e.o.isConnected)),r[t]!==e.val&&(e.p=e.val,e.val=r[t],e.t.forEach(o))}))};